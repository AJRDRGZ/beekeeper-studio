#! /bin/bash

OLD_FILE=/etc/apt/sources.list.d/beekeeper-studio.list
NEW_FILE=/etc/apt/sources.list.d/beekeeper-studio-app.list

available()
{
        command -v "$1" >/dev/null 2>&1
}

if [ -f $NEW_FILE ]; then
  exit 0
fi

if [ -f $OLD_FILE ]; then
  echo "--> Beekeeper Studio has migrated to a new apt repo, adding it, and removing the old one"
  echo "--> For more information see https://docs.beekeeperstudio.io/installation"
  rm -f $OLD_FILE
  rm -f $OLD_FILE.save
fi

if available apt-key
then
      apt-key add - >/dev/null <<EOF
-----BEGIN PGP PUBLIC KEY BLOCK-----

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
=+l7u
-----END PGP PUBLIC KEY BLOCK-----

EOF
    echo "deb https://deb.beekeeperstudio.io stable main" > $NEW_FILE
fi
